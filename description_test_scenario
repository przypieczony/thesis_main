(lp0
(dp1
S'sender'
p2
S'kamszy'
p3
sS'callid'
p4
S'lo1xtj'
p5
sS'receiver'
p6
S'revszy'
p7
sS'source_ip'
p8
S'127.107.11.20'
p9
sS'proxy_one_ip'
p10
S'127.165.182.92'
p11
sS'proxy_one_port'
p12
I59147
sS'proxy_two_ip'
p13
S'127.20.4.7'
p14
sS'proxy_two_port'
p15
I26984
sS'source_port'
p16
I2569
sS'dest_ip'
p17
S'127.0.0.1'
p18
sS'dest_port'
p19
I48246
sa(dp20
S'description'
p21
S'ąęćńśżxźProxy 1 inserts a Record-Route header into the INVITE message to ensure that it is present in all subsequent message exchanges. Proxy 2 also inserts itself into the Record-Route header. The ACK (F15) and BYE (F18) both have a Route header.'
p22
sg8
S'127.107.11.20'
p23
sS'template'
p24
S'INVITE sip:%(receiver)s@%(dest_ip)s:%(dest_port)s SIP/2.0\nVia: SIP/2.0/TCP %(source_ip)s:%(source_port)s;branch=z9hG4bK74b43\nMax-Forwards: 70\nRoute: <sip:%(proxy_one_ip)s:%(proxy_one_port)s;lr>\nFrom: %(sender)s <sip:%(sender)s@%(source_ip)s:%(source_port)s>;tag=9fxced76sl\nTo: %(receiver)s <sip:%(receiver)s@%(dest_ip)s:%(dest_port)s>\nCall-ID: 3848276298220188511@atlanta.example.com\nCSeq: 1 INVITE\nContact: <sip:%(sender)s@%(source_ip)s:%(source_port)s;transport=tcp>\nContent-Type: application/sdp\nContent-Length: 124\n\nv=0\no=%(sender)s 2890844526 2890844526 IN IP4 %(source_ip)s:%(source_port)s\ns=-\nc=IN IP4 %(source_ip)s\nt=0 0\nm=audio 49172 RTP/AVP 0\na=rtpmap:0 PCMU/8000'
p25
sg16
S'2569'
p26
sS'path'
p27
S'/home/kszymans/thesis_main/templates/F1_INVITE_call_est.txt'
p28
sg19
S'59147'
p29
sg17
S'127.165.182.92'
p30
sa(dp31
S'description'
p32
S'Proxy 1 challenges Alice for authentication. To: %(receiver)s <sip:%(receiver)s@%(dest_ip)s:%(dest_port)s> Call-ID: 3848276298220188511@atlanta.example.com CSeq: 1 INVITE Contact: <sip:%(sender)s@%(source_ip)s:%(source_port)s;transport=tcp> Content-Type: application/sdp Content-Length: 124'
p33
sS'source_ip'
p34
S'127.165.182.92'
p35
sS'template'
p36
S'SIP/2.0 407 Proxy Authorization Required\nVia: SIP/2.0/TCP %(source_ip)s:%(source_port)s;branch=z9hG4bK74b43;received=192.0.2.101\nFrom: %(sender)s <sip:%(sender)s@%(source_ip)s:%(source_port)s>;tag=9fxced76sl\nTo: %(receiver)s <sip:%(receiver)s@%(dest_ip)s:%(dest_port)s>;tag=3flal12sf\nCall-ID: 3848276298220188511@atlanta.example.com\nCSeq: 1 INVITE\nProxy-Authenticate: Digest realm="atlanta.example.com", qop="auth",nonce="f84f1cec41e6cbe5aea9c8e88d359",opaque="", stale=FALSE, algorithm=MD5\nContent-Length: 0'
p37
sS'source_port'
p38
S'59147'
p39
sS'path'
p40
S'/home/kszymans/thesis_main/templates/F2_407_call_est.txt'
p41
sS'dest_ip'
p42
S'127.107.11.20'
p43
sS'dest_port'
p44
S'2569'
p45
sa.
